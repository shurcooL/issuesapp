<html>
	<head>
		{{template "scriptless-head" .}}
	</head>
	<body>
		{{template "body-pre" .}}
		{{.BodyTop}}
		{{template "create-issue" .}}
		{{template "issues" .}}
	</body>
</html>

{{define "scriptless-head"}}
	{{.HeadPre}}
	<link href="{{.BaseURI}}/assets/gfm/gfm.css" rel="stylesheet" type="text/css" />
	<link href="{{.BaseURI}}/assets/style.css" rel="stylesheet" type="text/css" />
	{{.HeadPost}}
{{end}}

{{define "head"}}
	{{template "scriptless-head" .}}
	<script type="text/javascript">
		var State = {{.State | jsonfmt}};
		{{/*var State = {{.State}};*/}}
	</script>
	<script src="{{.BaseURI}}/assets/script/script.js" type="text/javascript"></script>
{{end}}

{{define "create-issue"}}
	{{if .CurrentUser.ID}}
		<div style="text-align: right;"><button class="btn btn-success btn-small" onclick="window.location = '{{.BaseURI}}/new';">Create Issue</button></div>
	{{end}}
{{end}}

{{define "issues"}}
<div class="list-entry list-entry-border">
	{{render .IssuesNav}}
	{{with .Issues}}{{range .}}
		{{template "issue-entry" .}}
	{{end}}{{else}}
		<div style="text-align: center; margin-top: 80px; margin-bottom: 80px;">There aren't any {{.Tab}} issues.</div>
	{{end}}
</div>
{{end}}

{{/* Dot is issue in display.go. */}}
{{define "issue-entry"}}
<div class="list-entry-body multilist-entry"{{if .Unread}} style="box-shadow: 2px 0 0 #4183c4 inset;"{{end}}>
	<div style="display: flex;">
		{{render (issueIcon .State)}}
		<div style="flex-grow: 1;">
			<div>
				<a class="black" href="{{state.BaseURI}}/{{.ID}}"><strong>{{.Title}}</strong></a>
				{{range .Labels}}{{render (label .)}}{{end}}
			</div>
			<div class="gray tiny">#{{.ID}} opened {{render (time .CreatedAt)}} by {{.User.Login}}</div>
		</div>
		<span title="{{.Replies}} replies" class="tiny {{if .Replies}}gray{{else}}lightgray{{end}}">{{octicon "comment"}} {{.Replies}}</span>
	</div>
</div>
{{end}}
